{"ast":null,"code":"import \"antd-mobile/lib/button/style/css\";\nimport _Button from \"antd-mobile/lib/button\";\nimport \"antd-mobile/lib/list-view/style/css\";\nimport _ListView from \"antd-mobile/lib/list-view\";\n\nvar _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/Users/Ryan/Projects/kedou/src/pages/Collect/index.js\";\n\nimport 'dplayer/dist/DPlayer.min.css';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PublicNavBar from '../../components/PublicNavBar';\nimport { delBoolCollect, delVideo, getBookCollect, getVideoCollect } from '../../store/action/collect';\nimport BookContent from './components/bookContent.js';\nimport TabExample from './components/tabs';\nimport VideoContent from './components/videoContent';\nimport './style.less';\nconst mapDispatchToProps = {\n  getBookCollect,\n  delVideo,\n  getVideoCollect,\n  delBoolCollect\n};\nlet Collect = (_dec = connect(({\n  userCollect\n}) => ({\n  userCollect\n}), mapDispatchToProps), _dec(_class = (_temp = class Collect extends Component {\n  constructor(props) {\n    super(props);\n\n    this.deleteBtn = () => {\n      if (this.state.page === 1) {\n        if (this.state.ids === '') {\n          return;\n        } else {\n          new Promise(resolve => {\n            this.props.delBoolCollect({\n              ids: this.state.ids,\n              user_id: sessionStorage.getItem('user_id'),\n              resolve\n            });\n          }).then(res => {\n            if (res.suc) {\n              new Promise(resolve => {\n                this.props.getBookCollect({\n                  user_id: sessionStorage.getItem('user_id'),\n                  resolve\n                });\n              }).then(res => {\n                if (res.length === 0) {\n                  this.setState({\n                    isEdit: false\n                  });\n                }\n\n                this.setState({\n                  bookCollectList: res,\n                  dataSourceBook: this.state.dataSourceBook.cloneWithRows(res),\n                  count: 0,\n                  ids: ''\n                });\n              });\n            }\n          });\n        }\n      } else {\n        if (this.state.ids === '') {\n          return;\n        } else {\n          new Promise(resolve => {\n            this.props.delVideo({\n              ids: this.state.ids,\n              user_id: sessionStorage.getItem('user_id'),\n              resolve\n            });\n          }).then(res => {\n            if (res.suc) {\n              new Promise(resolve => {\n                this.props.getVideoCollect({\n                  user_id: sessionStorage.getItem('user_id'),\n                  type: '2',\n                  resolve,\n                  rows: '10',\n                  page: '1'\n                });\n              }).then(res => {\n                if (res.length === 0) {\n                  this.setState({\n                    isEdit: false\n                  });\n                }\n\n                this.setState({\n                  videoCollectList: res,\n                  dataSource: this.state.dataSource.cloneWithRows(res),\n                  count: 0,\n                  ids: ''\n                });\n              });\n            }\n          });\n        }\n      }\n    };\n\n    this.onLeftClick = () => {\n      this.props.history.go(-1);\n    };\n\n    this.onRightClick = () => {\n      const data = JSON.parse(JSON.stringify(this.state.bookCollectList));\n      const data2 = JSON.parse(JSON.stringify(this.state.videoCollectList));\n      this.state.bookCollectList.forEach((item, index, arr) => {\n        data[index].isCheck = false;\n      });\n      this.state.videoCollectList.forEach((item, index, arr) => {\n        data2[index].isCheck = false;\n      });\n      this.setState({\n        isEdit: !this.state.isEdit,\n        count: 0,\n        checkedStatus: false,\n        bookCollectList: data,\n        videoCollectList: data2,\n        dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n        dataSource: this.state.dataSource.cloneWithRows(data2),\n        ids: ''\n      });\n    };\n\n    this.onTabChange = (v, i) => {\n      this.setState({\n        page: i\n      });\n      const data = JSON.parse(JSON.stringify(this.state.bookCollectList));\n      const data2 = JSON.parse(JSON.stringify(this.state.videoCollectList));\n      this.state.bookCollectList.forEach((item, index, arr) => {\n        data[index].isCheck = false;\n      });\n      this.state.videoCollectList.forEach((item, index, arr) => {\n        data2[index].isCheck = false;\n      });\n      this.setState({\n        checkedStatus: false,\n        bookCollectList: data,\n        videoCollectList: data2,\n        dataSource: this.state.dataSource.cloneWithRows(data2),\n        dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n        count: 0,\n        ids: '',\n        isLoading: true\n      });\n    };\n\n    this.selectAll = () => {\n      const data = JSON.parse(JSON.stringify(this.state.bookCollectList));\n      const data2 = JSON.parse(JSON.stringify(this.state.videoCollectList));\n      const checkedStatus = this.state.checkedStatus;\n\n      if (this.state.page === 0) {\n        //视频\n        const ids = data2.map(item => item.video_id);\n\n        if (!this.state.checkedStatus) {\n          this.state.videoCollectList.forEach((item, index, arr) => {\n            data2[index].isCheck = !checkedStatus;\n          });\n          this.setState({\n            checkedStatus: !checkedStatus,\n            videoCollectList: data2,\n            dataSource: this.state.dataSource.cloneWithRows(data2),\n            count: data2.length,\n            ids: ids.join(',')\n          });\n        } else {\n          this.state.videoCollectList.forEach((item, index, arr) => {\n            data2[index].isCheck = !checkedStatus;\n          });\n          this.setState({\n            checkedStatus: !checkedStatus,\n            videoCollectList: data2,\n            dataSource: this.state.dataSource.cloneWithRows(data2),\n            count: 0,\n            ids: ''\n          });\n        }\n      } else {\n        //听书\n        if (!this.state.checkedStatus) {\n          this.state.bookCollectList.forEach((item, index, arr) => {\n            data[index].isCheck = !checkedStatus;\n          });\n          const ids = data.map(item => item.novel_id);\n          this.setState({\n            checkedStatus: !checkedStatus,\n            bookCollectList: data,\n            dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n            count: data.length,\n            ids: ids.join(',')\n          });\n        } else {\n          this.state.bookCollectList.forEach((item, index, arr) => {\n            data[index].isCheck = !checkedStatus;\n          });\n          this.setState({\n            checkedStatus: !checkedStatus,\n            bookCollectList: data,\n            dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n            count: 0,\n            ids: ''\n          });\n        }\n      }\n    };\n\n    this.selectOne = (e, index, item) => {\n      const data = JSON.parse(JSON.stringify(this.state.bookCollectList));\n      data[index].isCheck = e.target.checked;\n      const deleteData = data.filter(val => val.isCheck === true);\n      const ids = deleteData.map(val => val.novel_id);\n      const flag = data.filter(val => val.isCheck === false);\n\n      if (flag.length === 0) {\n        this.setState({\n          checkedStatus: true\n        });\n      } else {\n        this.setState({\n          checkedStatus: false\n        });\n      }\n\n      this.setState({\n        bookCollectList: data,\n        dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n        ids: ids.join(',')\n      });\n\n      if (item.isCheck) {\n        this.setState({\n          count: this.state.count - 1\n        });\n      } else {\n        this.setState({\n          count: this.state.count + 1\n        });\n      }\n    };\n\n    this.selectOne2 = (e, index, item) => {\n      const data = JSON.parse(JSON.stringify(this.state.videoCollectList));\n      data[index].isCheck = e.target.checked;\n      const deleteData = data.filter(val => val.isCheck === true);\n      const ids = deleteData.map(val => val.video_id);\n      const flag = data.filter(val => val.isCheck === false);\n\n      if (flag.length === 0) {\n        this.setState({\n          checkedStatus: true\n        });\n      } else {\n        this.setState({\n          checkedStatus: false\n        });\n      }\n\n      this.setState({\n        videoCollectList: data,\n        dataSource: this.state.dataSource.cloneWithRows(data),\n        ids: ids.join(',')\n      });\n\n      if (item.isCheck) {\n        this.setState({\n          count: this.state.count - 1\n        });\n      } else {\n        this.setState({\n          count: this.state.count + 1\n        });\n      }\n    };\n\n    this.goToBook = item => {\n      window.sessionStorage.setItem('goBack', 'true');\n      this.props.history.push({\n        pathname: 'book',\n        state: {\n          id: item.novel_id\n        }\n      });\n    };\n\n    this.goToVideo = item => {\n      window.sessionStorage.setItem('goBack', 'true');\n      const user_id = sessionStorage.getItem('user_id');\n      this.props.history.push(`/detailVideo/video_id=${item.video_id}&user_id=${user_id}`);\n    };\n\n    this.callBackStateVideo = () => {\n      this.setState({\n        isLoading: true\n      });\n\n      if (this.state.isStop) {\n        this.setState({\n          isLoading: false\n        });\n        return;\n      } else {\n        new Promise(resolve => {\n          this.props.getVideoCollect({\n            user_id: sessionStorage.getItem('user_id'),\n            type: '2',\n            resolve,\n            rows: '10',\n            page: String(this.state.videoPage + 1)\n          });\n        }).then(res => {\n          if (res.length === 0) {\n            this.setState({\n              isStop: true,\n              isLoading: false,\n              loadingText: '没有更多了'\n            });\n            return;\n          }\n\n          const newData = this.state.videoCollectList;\n          newData.push(...res);\n          this.setState({\n            videoPage: this.state.videoPage + 1,\n            videoCollectList: newData,\n            dataSource: this.state.dataSource.cloneWithRows(newData),\n            isLoading: false\n          });\n        });\n      }\n    };\n\n    this.callBackStateBook = () => {\n      this.setState({\n        isLoading: true\n      });\n\n      if (this.state.isStopBook) {\n        this.setState({\n          isLoading: false\n        });\n        return;\n      } else {\n        new Promise(resolve => {\n          this.props.getBookCollect({\n            user_id: sessionStorage.getItem('user_id'),\n            resolve,\n            rows: '10',\n            page: String(this.state.bookPage + 1)\n          });\n        }).then(res => {\n          if (res.length === 0) {\n            this.setState({\n              isStopBook: true,\n              isLoading: false,\n              loadingText: '没有更多了'\n            });\n            return;\n          }\n\n          const newData = this.state.bookCollectList;\n          newData.push(...res);\n          this.setState({\n            bookPage: this.state.bookPage + 1,\n            isLoading: false,\n            bookCollectList: newData,\n            dataSourceBook: this.state.dataSourceBook.cloneWithRows(newData)\n          });\n        });\n      }\n    };\n\n    const dataSource = new _ListView.DataSource({\n      rowHasChanged: (row1, row2) => row1 !== row2\n    });\n    const dataSourceBook = new _ListView.DataSource({\n      rowHasChanged: (row1, row2) => row1 !== row2\n    });\n    this.state = {\n      isShow: true,\n      //根据值判断是否显示带有loading的foot\n      loadingText: '加载完成',\n      videoPage: 1,\n      bookPage: 1,\n      isLoading: true,\n      isStop: false,\n      isStopBook: false,\n      dataSourceBook,\n      dataSource,\n      user_id: '',\n      ids: '',\n      //听书id\n      isEdit: false,\n      checkedStatus: false,\n      //全选为true\n      page: 0,\n      //根据tabs页面决定全选哪个版块内容\n      count: 0,\n      //选中了几个\n      bookCollectList: [],\n      //听书收藏数据\n      videoCollectList: [] //视频收藏数据\n\n    };\n  }\n\n  componentDidMount() {\n    new Promise(resolve => {\n      this.props.getBookCollect({\n        user_id: sessionStorage.getItem('user_id'),\n        resolve // rows: '10',\n        // page: '1',\n\n      });\n    }).then(res => {\n      this.setState({\n        bookCollectList: res,\n        dataSourceBook: this.state.dataSourceBook.cloneWithRows(res),\n        isLoading: false\n      });\n    });\n    new Promise(resolve => {\n      this.props.getVideoCollect({\n        user_id: sessionStorage.getItem('user_id'),\n        type: '2',\n        resolve,\n        rows: '10',\n        page: '1'\n      });\n    }).then(res => {\n      if (res.length === 0) {\n        this.setState({\n          isShow: false\n        });\n      } else {\n        this.setState({\n          isShow: true,\n          videoCollectList: res,\n          dataSource: this.state.dataSource.cloneWithRows(res),\n          isLoading: false\n        });\n      }\n    });\n  }\n\n  render() {\n    const navBarProps = {\n      title: '我的收藏',\n      edit: true,\n      onLeftClick: this.onLeftClick,\n      onRightClick: this.onRightClick,\n      isEdit: this.state.isEdit\n    };\n\n    const videoTab = () => {\n      const videoPros = {\n        isEdit: this.state.isEdit,\n        selectOne2: this.selectOne2,\n        dataSource: this.state.dataSource,\n        videoCollectList: this.state.videoCollectList,\n        isLoading: this.state.isLoading,\n        callBackStateVideo: this.callBackStateVideo,\n        goToVideo: this.goToVideo,\n        loadingText: this.state.loadingText,\n        isShow: this.state.isShow\n      };\n      return React.createElement(VideoContent, Object.assign({}, videoPros, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 414\n        },\n        __self: this\n      }));\n    };\n\n    const bookTab = () => {\n      const bookPros = {\n        isEdit: this.state.isEdit,\n        selectOne: this.selectOne,\n        isLoading: this.state.isLoading,\n        goToBook: this.goToBook,\n        loadingText: this.state.loadingText,\n        bookCollectList: this.state.bookCollectList,\n        dataSourceBook: this.state.dataSourceBook,\n        callBackStateBook: this.callBackStateBook\n      };\n      return React.createElement(BookContent, Object.assign({}, bookPros, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 428\n        },\n        __self: this\n      }));\n    };\n\n    const tabs = [{\n      title: '视频'\n    }, {\n      title: '听书'\n    }];\n    return React.createElement(\"div\", {\n      style: {\n        backgroundColor: '#fff'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 435\n      },\n      __self: this\n    }, React.createElement(PublicNavBar, Object.assign({}, navBarProps, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436\n      },\n      __self: this\n    })), React.createElement(TabExample, {\n      tabs: tabs,\n      tabsContent1: videoTab,\n      tabsContent2: bookTab,\n      onTabChange: this.onTabChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 437\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        display: this.state.isEdit ? 'flex' : 'none',\n        justifyContent: 'center',\n        position: 'fixed',\n        width: '100vw',\n        bottom: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443\n      },\n      __self: this\n    }, React.createElement(_Button, {\n      onClick: this.selectAll,\n      style: {\n        flex: '1',\n        borderRadius: 0,\n        color: '#7914ee'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450\n      },\n      __self: this\n    }, this.state.checkedStatus ? '反选' : '全选'), React.createElement(_Button, {\n      onClick: this.deleteBtn,\n      style: {\n        flex: '1',\n        borderRadius: 0,\n        color: '#7914ee'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 456\n      },\n      __self: this\n    }, this.state.count !== 0 ? `删除(${this.state.count})` : '删除')));\n  }\n\n}, _temp)) || _class);\nexport default Collect;","map":{"version":3,"sources":["/Users/Ryan/Projects/kedou/src/pages/Collect/index.js"],"names":["React","Component","connect","PublicNavBar","delBoolCollect","delVideo","getBookCollect","getVideoCollect","BookContent","TabExample","VideoContent","mapDispatchToProps","Collect","userCollect","constructor","props","deleteBtn","state","page","ids","Promise","resolve","user_id","sessionStorage","getItem","then","res","suc","length","setState","isEdit","bookCollectList","dataSourceBook","cloneWithRows","count","type","rows","videoCollectList","dataSource","onLeftClick","history","go","onRightClick","data","JSON","parse","stringify","data2","forEach","item","index","arr","isCheck","checkedStatus","onTabChange","v","i","isLoading","selectAll","map","video_id","join","novel_id","selectOne","e","target","checked","deleteData","filter","val","flag","selectOne2","goToBook","window","setItem","push","pathname","id","goToVideo","callBackStateVideo","isStop","String","videoPage","loadingText","newData","callBackStateBook","isStopBook","bookPage","DataSource","rowHasChanged","row1","row2","isShow","componentDidMount","render","navBarProps","title","edit","videoTab","videoPros","bookTab","bookPros","tabs","backgroundColor","display","justifyContent","position","width","bottom","flex","borderRadius","color"],"mappings":"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","sourcesContent":["import { Button, ListView } from 'antd-mobile';\nimport 'dplayer/dist/DPlayer.min.css';\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PublicNavBar from '../../components/PublicNavBar';\nimport { delBoolCollect, delVideo, getBookCollect, getVideoCollect } from '../../store/action/collect';\nimport BookContent from './components/bookContent.js';\nimport TabExample from './components/tabs';\nimport VideoContent from './components/videoContent';\nimport './style.less';\n\nconst mapDispatchToProps = {\n  getBookCollect,\n  delVideo,\n  getVideoCollect,\n  delBoolCollect\n};\n\n@connect(({ userCollect }) => ({\n  userCollect\n}), mapDispatchToProps)\nclass Collect extends Component {\n  constructor(props) {\n    super(props)\n    const dataSource = new ListView.DataSource({\n      rowHasChanged: (row1, row2) => row1 !== row2,\n    });\n    const dataSourceBook = new ListView.DataSource({\n      rowHasChanged: (row1, row2) => row1 !== row2,\n    });\n    this.state = {\n      isShow: true,//根据值判断是否显示带有loading的foot\n      loadingText: '加载完成',\n      videoPage: 1,\n      bookPage: 1,\n      isLoading: true,\n      isStop: false,\n      isStopBook: false,\n      dataSourceBook,\n      dataSource,\n      user_id: '',\n      ids: '',//听书id\n      isEdit: false,\n      checkedStatus: false, //全选为true\n      page: 0,//根据tabs页面决定全选哪个版块内容\n      count: 0,//选中了几个\n      bookCollectList: [],//听书收藏数据\n      videoCollectList: [],//视频收藏数据\n    }\n  }\n\n  componentDidMount() {\n    new Promise(resolve => {\n      this.props.getBookCollect({\n        user_id: sessionStorage.getItem('user_id'),\n        resolve,\n        // rows: '10',\n        // page: '1',\n      })\n    }).then(res => {\n      this.setState({\n        bookCollectList: res,\n        dataSourceBook: this.state.dataSourceBook.cloneWithRows(res),\n        isLoading: false,\n      })\n    });\n\n\n    new Promise(resolve => {\n      this.props.getVideoCollect({\n        user_id: sessionStorage.getItem('user_id'),\n        type: '2',\n        resolve,\n        rows: '10',\n        page: '1',\n      })\n    }).then(res => {\n      if (res.length === 0) {\n        this.setState({\n          isShow: false\n        })\n      } else {\n        this.setState({\n          isShow: true,\n          videoCollectList: res,\n          dataSource: this.state.dataSource.cloneWithRows(res),\n          isLoading: false,\n        })\n      }\n    })\n  }\n\n  deleteBtn = () => {\n    if (this.state.page === 1) {\n      if (this.state.ids === '') {\n        return\n      } else {\n        new Promise(resolve => {\n          this.props.delBoolCollect({\n            ids: this.state.ids,\n            user_id: sessionStorage.getItem('user_id'),\n            resolve\n          })\n        }).then(res => {\n          if (res.suc) {\n            new Promise(resolve => {\n              this.props.getBookCollect({ user_id: sessionStorage.getItem('user_id'), resolve })\n            }).then(res => {\n              if (res.length === 0) {\n                this.setState({\n                  isEdit: false\n                })\n              }\n              this.setState({\n                bookCollectList: res,\n                dataSourceBook: this.state.dataSourceBook.cloneWithRows(res),\n                count: 0,\n                ids: '',\n              })\n            })\n          }\n        })\n      }\n    } else {\n      if (this.state.ids === '') {\n        return\n      } else {\n        new Promise(resolve => {\n          this.props.delVideo({\n            ids: this.state.ids,\n            user_id: sessionStorage.getItem('user_id'),\n            resolve\n          })\n        }).then(res => {\n          if (res.suc) {\n            new Promise(resolve => {\n              this.props.getVideoCollect({\n                user_id: sessionStorage.getItem('user_id'),\n                type: '2',\n                resolve,\n                rows: '10',\n                page: '1',\n              })\n            }).then(res => {\n              if (res.length === 0) {\n                this.setState({\n                  isEdit: false\n                })\n              }\n              this.setState({\n                videoCollectList: res,\n                dataSource: this.state.dataSource.cloneWithRows(res),\n                count: 0,\n                ids: '',\n              })\n            })\n          }\n        })\n      }\n    }\n  }\n\n  onLeftClick = () => {\n    this.props.history.go(-1)\n  }\n  // 编辑按钮\n  onRightClick = () => {\n    const data = JSON.parse(JSON.stringify(this.state.bookCollectList))\n    const data2 = JSON.parse(JSON.stringify(this.state.videoCollectList))\n\n    this.state.bookCollectList.forEach((item, index, arr) => {\n      data[index].isCheck = false\n    })\n    this.state.videoCollectList.forEach((item, index, arr) => {\n      data2[index].isCheck = false\n    })\n    this.setState({\n      isEdit: !this.state.isEdit,\n      count: 0,\n      checkedStatus: false,\n      bookCollectList: data,\n      videoCollectList: data2,\n      dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n      dataSource: this.state.dataSource.cloneWithRows(data2),\n      ids: '',\n    });\n  }\n  //切换Tab取消勾选的项目\n  onTabChange = (v, i) => {\n    this.setState({ page: i })\n    const data = JSON.parse(JSON.stringify(this.state.bookCollectList))\n    const data2 = JSON.parse(JSON.stringify(this.state.videoCollectList))\n    this.state.bookCollectList.forEach((item, index, arr) => {\n      data[index].isCheck = false\n    })\n    this.state.videoCollectList.forEach((item, index, arr) => {\n      data2[index].isCheck = false\n    })\n    this.setState({\n      checkedStatus: false,\n      bookCollectList: data,\n      videoCollectList: data2,\n      dataSource: this.state.dataSource.cloneWithRows(data2),\n      dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n      count: 0,\n      ids: '',\n      isLoading: true\n    })\n  }\n  //全选\n  selectAll = () => {\n    const data = JSON.parse(JSON.stringify(this.state.bookCollectList))\n    const data2 = JSON.parse(JSON.stringify(this.state.videoCollectList))\n    const checkedStatus = this.state.checkedStatus\n    if (this.state.page === 0) {//视频\n      const ids = data2.map(item => item.video_id)\n      if (!this.state.checkedStatus) {\n        this.state.videoCollectList.forEach((item, index, arr) => {\n          data2[index].isCheck = !checkedStatus\n        })\n        this.setState({\n          checkedStatus: !checkedStatus,\n          videoCollectList: data2,\n          dataSource: this.state.dataSource.cloneWithRows(data2),\n          count: data2.length,\n          ids: ids.join(',')\n        })\n      } else {\n        this.state.videoCollectList.forEach((item, index, arr) => {\n          data2[index].isCheck = !checkedStatus\n        })\n        this.setState({\n          checkedStatus: !checkedStatus,\n          videoCollectList: data2,\n          dataSource: this.state.dataSource.cloneWithRows(data2),\n          count: 0,\n          ids: '',\n        })\n      }\n    } else {//听书\n      if (!this.state.checkedStatus) {\n        this.state.bookCollectList.forEach((item, index, arr) => {\n          data[index].isCheck = !checkedStatus\n        })\n        const ids = data.map(item => item.novel_id)\n        this.setState({\n          checkedStatus: !checkedStatus,\n          bookCollectList: data,\n          dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n          count: data.length,\n          ids: ids.join(',')\n        })\n      } else {\n        this.state.bookCollectList.forEach((item, index, arr) => {\n          data[index].isCheck = !checkedStatus\n        })\n        this.setState({\n          checkedStatus: !checkedStatus,\n          bookCollectList: data,\n          dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n          count: 0,\n          ids: ''\n        })\n      }\n    }\n  }\n  //听书单选\n  selectOne = (e, index, item) => {\n    const data = JSON.parse(JSON.stringify(this.state.bookCollectList))\n    data[index].isCheck = e.target.checked\n    const deleteData = data.filter(val => val.isCheck === true)\n    const ids = deleteData.map(val => val.novel_id)\n    const flag = data.filter(val => val.isCheck === false)\n    if (flag.length === 0) {\n      this.setState({ checkedStatus: true })\n    } else {\n      this.setState({ checkedStatus: false })\n    }\n    this.setState({\n      bookCollectList: data,\n      dataSourceBook: this.state.dataSourceBook.cloneWithRows(data),\n      ids: ids.join(',')\n    });\n    if (item.isCheck) {\n      this.setState({ count: this.state.count - 1 })\n    } else {\n      this.setState({ count: this.state.count + 1 })\n    }\n  }\n  //视频单选\n  selectOne2 = (e, index, item) => {\n    const data = JSON.parse(JSON.stringify(this.state.videoCollectList))\n    data[index].isCheck = e.target.checked\n    const deleteData = data.filter(val => val.isCheck === true)\n    const ids = deleteData.map(val => val.video_id)\n    const flag = data.filter(val => val.isCheck === false)\n    if (flag.length === 0) {\n      this.setState({ checkedStatus: true })\n    } else {\n      this.setState({ checkedStatus: false })\n    }\n    this.setState({\n      videoCollectList: data,\n      dataSource: this.state.dataSource.cloneWithRows(data),\n      ids: ids.join(',')\n    });\n    if (item.isCheck) {\n      this.setState({ count: this.state.count - 1 })\n    } else {\n      this.setState({ count: this.state.count + 1 })\n    }\n  }\n\n  goToBook = (item) => {\n    window.sessionStorage.setItem('goBack', 'true')\n    this.props.history.push({ pathname: 'book', state: { id: item.novel_id } })\n  }\n\n  goToVideo = (item) => {\n    window.sessionStorage.setItem('goBack', 'true')\n    const user_id = sessionStorage.getItem('user_id');\n    this.props.history.push(`/detailVideo/video_id=${item.video_id}&user_id=${user_id}`);\n  }\n\n  callBackStateVideo = () => {\n    this.setState({ isLoading: true });\n    if (this.state.isStop) {\n      this.setState({ isLoading: false });\n      return\n    } else {\n      new Promise(resolve => {\n        this.props.getVideoCollect({\n          user_id: sessionStorage.getItem('user_id'),\n          type: '2',\n          resolve,\n          rows: '10',\n          page: String(this.state.videoPage + 1),\n        })\n      }).then(res => {\n        if (res.length === 0) {\n          this.setState({\n            isStop: true,\n            isLoading: false,\n            loadingText: '没有更多了'\n          })\n          return\n        }\n        const newData = this.state.videoCollectList\n        newData.push(...res)\n        this.setState({\n          videoPage: this.state.videoPage + 1,\n          videoCollectList: newData,\n          dataSource: this.state.dataSource.cloneWithRows(newData),\n          isLoading: false,\n        })\n      })\n    }\n  }\n\n  callBackStateBook = () => {\n    this.setState({ isLoading: true });\n    if (this.state.isStopBook) {\n      this.setState({ isLoading: false });\n      return\n    } else {\n      new Promise(resolve => {\n        this.props.getBookCollect({\n          user_id: sessionStorage.getItem('user_id'),\n          resolve,\n          rows: '10',\n          page: String(this.state.bookPage + 1),\n        })\n      }).then(res => {\n        if (res.length === 0) {\n          this.setState({\n            isStopBook: true,\n            isLoading: false,\n            loadingText: '没有更多了'\n          })\n          return\n        }\n        const newData = this.state.bookCollectList\n        newData.push(...res)\n        this.setState({\n          bookPage: this.state.bookPage + 1,\n          isLoading: false,\n          bookCollectList: newData,\n          dataSourceBook: this.state.dataSourceBook.cloneWithRows(newData),\n        })\n      })\n    }\n  }\n\n  render() {\n    const navBarProps = {\n      title: '我的收藏',\n      edit: true,\n      onLeftClick: this.onLeftClick,\n      onRightClick: this.onRightClick,\n      isEdit: this.state.isEdit\n    }\n    const videoTab = () => {\n      const videoPros = {\n        isEdit: this.state.isEdit,\n        selectOne2: this.selectOne2,\n        dataSource: this.state.dataSource,\n        videoCollectList: this.state.videoCollectList,\n        isLoading: this.state.isLoading,\n        callBackStateVideo: this.callBackStateVideo,\n        goToVideo: this.goToVideo,\n        loadingText: this.state.loadingText,\n        isShow: this.state.isShow\n      }\n      return <VideoContent {...videoPros} />\n    }\n\n    const bookTab = () => {\n      const bookPros = {\n        isEdit: this.state.isEdit,\n        selectOne: this.selectOne,\n        isLoading: this.state.isLoading,\n        goToBook: this.goToBook,\n        loadingText: this.state.loadingText,\n        bookCollectList: this.state.bookCollectList,\n        dataSourceBook: this.state.dataSourceBook,\n        callBackStateBook: this.callBackStateBook,\n      }\n      return <BookContent {...bookPros} />\n    }\n    const tabs = [\n      { title: '视频' },\n      { title: '听书' },\n    ];\n    return (\n      <div style={{ backgroundColor: '#fff' }}>\n        <PublicNavBar {...navBarProps} />\n        <TabExample\n          tabs={tabs}\n          tabsContent1={videoTab}\n          tabsContent2={bookTab}\n          onTabChange={this.onTabChange}\n        />\n        <div style={{\n          display: this.state.isEdit ? 'flex' : 'none',\n          justifyContent: 'center',\n          position: 'fixed',\n          width: '100vw',\n          bottom: 0\n        }}>\n          <Button\n            onClick={this.selectAll}\n            style={{ flex: '1', borderRadius: 0, color: '#7914ee' }}\n          >\n            {this.state.checkedStatus ? '反选' : '全选'}\n          </Button>\n          <Button onClick={this.deleteBtn} style={{ flex: '1', borderRadius: 0, color: '#7914ee' }}>{this.state.count !== 0 ? `删除(${this.state.count})` : '删除'}</Button>\n        </div>\n      </div >\n    )\n  }\n}\nexport default Collect\n"]},"metadata":{},"sourceType":"module"}